<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script>
        var datosVentas = '';

        function datos() {

            var num = document.getElementById("cantidadInput").value;
            datosVentas = `USE punto_venta;<br>
            DELETE FROM venta_detalle;<br>
            DELETE FROM venta;<br>
            INSERT INTO venta(idVenta, fecha, hora)VALUES <br>(1,'`
                + fechaAleatoria() + "', '" + horaAleatoria() + "'),";

            for (let index = 2; index <= num; index++) {
                datosVentas += "<br>( " + index + " , '" + fechaAleatoria()
                    + "' , '" + horaAleatoria() + "'),";
            }

            if (datosVentas.endsWith(',')) {
                datosVentas = datosVentas.slice(0, -1) + ';';
            }

            datosVentas += `<br>
                INSERT INTO venta_detalle (IDVenta, IDProducto) VALUES
            `;

            for (let i = 1; i <= num; i++) {

                var idVenta = Math.floor(Math.random() * 10);

                for (let j = 0; j <= idVenta; j++) {

                    datosVentas += "<br>(" + i + "," + Math.floor(1 + Math.random() * 10) + "),";

                }

            }

            if (datosVentas.endsWith(',')) {
                datosVentas = datosVentas.slice(0, -1) + ';';
            }

            document.getElementById("resultado").innerHTML = datosVentas;
        }

        function fechaAleatoria() {
            var año = Math.floor(Math.random() * (2022 - 2000 + 1)) + 2000;
            var mes = Math.floor(Math.random() * 12) + 1;
            var dia = Math.floor(Math.random() * 31) + 1;
            var hora = Math.floor(Math.random() * 24);
            var minuto = Math.floor(Math.random() * 60);
            var segundo = Math.floor(Math.random() * 60);

            var fechaAleatoria = new Date(año, mes - 1, dia, hora, minuto, segundo);

            var fechaFormateada = fechaAleatoria.toISOString().split('T')[0];

            return fechaFormateada;
        }

        function horaAleatoria() {
            var horas = Math.floor(Math.random() * 24);
            var minutos = Math.floor(Math.random() * 60);
            var segundos = Math.floor(Math.random() * 60);

            var horaFormateada = rellenarCerosIzquierda(horas) + ":" + rellenarCerosIzquierda(minutos) + ":" + rellenarCerosIzquierda(segundos);

            return horaFormateada;
        }

        function rellenarCerosIzquierda(numero) {
            return numero < 10 ? "0" + numero : numero;
        }

        function archivoSQL() {

            var archivo = document.createElement('a');
            var salida = datosVentas.replace(/<br>/g, '\n').trim();

            archivo.setAttribute('href', 'data:text/plane;charset=utf-8,'
                + encodeURIComponent(salida));
            archivo.setAttribute('download', 'punto_venta.sql');

            archivo.style.display = 'none';

            document.body.appendChild(archivo);

            archivo.click();

            document.body.removeChild(archivo);

        }

    </script>

</head>

<body>
    <input type="button" value=" Generar Ventas" onclick="datos()">
    <br>
    <input type="button" value="Descargar SQL" onclick="archivoSQL()">
    <input type="number" name="numero" id="cantidadInput" min="0" value="10">

    <p id="resultado">
    </p>
</body>

</html>
